<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pacote Arcade Ultra 2.0</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Comic Sans MS',cursive,sans-serif;background:#000;color:#fff;overflow:hidden;}
button{padding:15px 30px;margin:10px;font-size:20px;font-weight:bold;border:none;border-radius:30px;cursor:pointer;background:linear-gradient(45deg,#ff416c,#ff4b2b);color:#fff;box-shadow:0 0 20px #fff,0 0 40px rgba(255,255,255,0.3);transition:0.3s;}
button:hover{transform:scale(1.15);box-shadow:0 0 60px #fff,0 0 100px rgba(255,255,255,0.6);}
canvas{display:block;margin:20px auto;border-radius:20px;box-shadow:0 0 60px rgba(255,255,255,0.5);}
#scoreBoard{margin:20px;font-size:24px;font-weight:bold;text-shadow:0 0 20px yellow;}
.screen{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;background: rgba(0,0,0,0.9);opacity:0;pointer-events:none;transition: opacity 0.5s;}
.screen.active{opacity:1;pointer-events:auto;}
.countdown{font-size:120px;font-weight:bold;color:yellow;text-shadow:0 0 40px #fff,0 0 80px yellow;}
#ticTacToeBoard{display:grid;grid-template-columns:repeat(3,100px);grid-template-rows:repeat(3,100px);gap:10px;margin-top:20px;}
.ticCell{width:100px;height:100px;background:#111;color:#fff;font-size:48px;display:flex;align-items:center;justify-content:center;border-radius:15px;cursor:pointer;box-shadow:0 0 20px #00ffff,0 0 40px #00ffff inset;text-shadow:0 0 10px #fff,0 0 20px cyan,0 0 30px cyan;transition:background 0.3s, transform 0.3s;}
.ticCell:hover{background:#333;transform:scale(1.1);}
#roundInfo{margin-top:15px;font-size:20px;text-shadow:0 0 10px #fff;}
#pauseOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:10;}
#pauseOverlay h2{font-size:50px;color:yellow;text-shadow:0 0 20px #fff,0 0 40px yellow;margin-bottom:20px;}
</style>
</head>
<body>

<!-- TELAS -->
<div id="startScreen" class="screen active">
  <h1 style="text-shadow:0 0 20px cyan,0 0 40px cyan;">üéÆ Pacote Arcade Ultra 2.0 üéÆ</h1>
  <button onclick="startGame()">START</button>
</div>

<div id="gameMenu" class="screen">
  <h2>Escolha seu jogo:</h2>
  <button onclick="startCountdownWithTips('falling')">üçé Falling Object</button>
  <button onclick="openTicTacToeSettings()">‚ùå‚≠ï Jogo da Velha</button>
  <button onclick="startCountdownWithTips('snake')">üêç Snake</button>
</div>

<div id="ticTacToeSettings" class="screen">
  <h2>Configura√ß√µes Jogo da Velha</h2>
  <p>Escolha o modo de jogo:</p>
  <button onclick="setGameMode('single')">1 Jogador (vs IA)</button>
  <button onclick="setGameMode('two')">2 Jogadores</button>
  <div id="roundSelection" style="margin-top:20px; display:none;">
    <p>Escolha o n√∫mero de rodadas:</p>
    <select id="roundsInput" style="padding:10px; font-size:18px;">
      <option value="1">1</option><option value="3">3</option><option value="5">5</option><option value="7">7</option>
    </select>
    <br><button onclick="confirmTicTacToeSettings()">Confirmar</button>
  </div>
</div>

<div id="tipsScreen" class="screen">
  <h2 id="tipsTitle">Como Jogar</h2>
  <p id="tipsText" style="font-size:20px;text-align:center;margin:20px;"></p>
  <button id="tipsNext">üéÆ Come√ßar Jogo</button>
</div>

<div id="gameContainer" class="screen">
  <div id="scoreBoard">Pontua√ß√£o: 0 | Vidas: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
  <canvas id="gameCanvas" width="500" height="500"></canvas>
  <div id="ticTacToeBoard" style="display:none;"></div>
  <div id="roundInfo"></div>
  <button onclick="returnToMenu()">üè† Voltar ao Menu</button>
</div>

<div id="countdownScreen" class="screen">
  <div class="countdown" id="countdownNumber">3</div>
</div>

<div id="pauseOverlay">
  <h2>‚è∏ Pausado</h2>
  <button onclick="resumeGame()">‚ñ∂ Retomar</button>
  <button onclick="returnToMenu()">üè† Sair para o Menu</button>
</div>

<script>
let score=0,lives=3,gameInterval,currentGame='';
let ticMode='two',totalRounds=1,currentRound=1,roundWins={X:0,O:0};
let isPaused=false;

// Telas
const startScreen=document.getElementById('startScreen');
const gameMenu=document.getElementById('gameMenu');
const gameContainer=document.getElementById('gameContainer');
const countdownScreen=document.getElementById('countdownScreen');
const countdownNumber=document.getElementById('countdownNumber');
const scoreBoard=document.getElementById('scoreBoard');
const canvas=document.getElementById('gameCanvas');
const ctx=canvas.getContext('2d');
const ticTacToeBoard=document.getElementById('ticTacToeBoard');
const roundInfo=document.getElementById('roundInfo');
const tipsScreen=document.getElementById('tipsScreen');
const tipsTitle=document.getElementById('tipsTitle');
const tipsText=document.getElementById('tipsText');
const tipsNext=document.getElementById('tipsNext');
const pauseOverlay=document.getElementById('pauseOverlay');

// START
function startGame(){ showScreen(gameMenu); }

// Pausa com espa√ßo
document.addEventListener('keydown',e=>{
  if(e.code==='Space' && currentGame) togglePause();
});
function togglePause(){ if(isPaused) resumeGame(); else pauseGame(); }
function pauseGame(){ isPaused=true; clearInterval(gameInterval); pauseOverlay.style.display='flex'; }
function resumeGame(){ 
  isPaused=false; 
  pauseOverlay.style.display='none'; 
  if(currentGame==='falling') gameInterval=setInterval(updateFallingGame,20); 
  else if(currentGame==='snake') gameInterval=setInterval(updateSnake,150); 
}

// Atualiza scoreboard
function updateScoreBoard(){ 
  scoreBoard.textContent=`Pontua√ß√£o: ${score} | Vidas: ${'‚ù§Ô∏è'.repeat(lives)}`; 
}

// Troca de tela
function showScreen(screen){ 
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active')); 
  screen.classList.add('active'); 
}
function startCountdownWithTips(game){
  let title='',text='';
  switch(game){
    case 'falling': title='üçé Falling Object'; text='Use as setas esquerda/direita para mover o coletor.\nPegue os objetos coloridos para ganhar pontos.\nEvite perder objetos!'; break;
    case 'tictactoe': title='‚ùå‚≠ï Jogo da Velha'; text='Clique em uma c√©lula para marcar X ou O.\nAlinhe 3 s√≠mbolos na horizontal, vertical ou diagonal.'; break;
    case 'snake': title='üêç Snake'; text='Use as setas para mover a cobrinha.\nComa a ma√ß√£ para crescer.\nEvite bater nas paredes ou em si mesmo.'; break;
  }
  tipsTitle.textContent=title; tipsText.textContent=text;
  showScreen(tipsScreen);
  tipsNext.onclick=()=>startCountdown(game);
}

// Contador antes do jogo
function startCountdown(game){
  showScreen(countdownScreen);
  let counter=3;
  countdownNumber.textContent=counter;
  const interval=setInterval(()=>{
    counter--;
    if(counter>0) countdownNumber.textContent=counter;
    else { clearInterval(interval); startSelectedGame(game); }
  },1000);
}

// Seleciona jogo
function startSelectedGame(game){
  switch(game){
    case 'falling': launchFallingGame(); break;
    case 'tictactoe': launchTicTacToe(); break;
    case 'snake': launchSnake(); break;
  }
}

// Volta menu
function returnToMenu(){
  clearInterval(gameInterval); 
  currentGame=''; 
  isPaused=false;
  canvas.style.display='block'; 
  ticTacToeBoard.style.display='none'; 
  roundInfo.textContent='';
  pauseOverlay.style.display='none'; 
  showScreen(gameMenu);
}

// ===================== FALLING OBJECT =====================
let objects=[],particles=[],bgParticles=[],player,keys={};
class Particle{
  constructor(x,y,color,size,speed){
    this.x=x;this.y=y;this.color=color;this.size=size;
    this.dx=(Math.random()-0.5)*speed;this.dy=(Math.random()-0.5)*speed;this.life=30+Math.random()*30;
  }
  update(){this.x+=this.dx;this.y+=this.dy;this.life--;}
  draw(ctx){ctx.fillStyle=this.color;ctx.shadowColor=this.color;ctx.shadowBlur=25;ctx.fillRect(this.x,this.y,this.size,this.size);ctx.shadowBlur=0;}
}
function launchFallingGame(){
  showScreen(gameContainer); 
  currentGame='falling'; 
  score=0;lives=3;updateScoreBoard();
  canvas.style.display='block'; 
  ticTacToeBoard.style.display='none'; 
  objects=[];particles=[];bgParticles=[];keys={};
  player={x:canvas.width/2-25,y:canvas.height-35,width:50,height:25,speed:6,velX:0};
  for(let i=0;i<50;i++) bgParticles.push(new Particle(Math.random()*canvas.width,Math.random()*canvas.height,'rgba(255,255,255,0.1)',2,0.5));
  window.addEventListener('keydown',e=>keys[e.key]=true);
  window.addEventListener('keyup',e=>keys[e.key]=false);
  gameInterval=setInterval(updateFallingGame,20);
}
function generateObject(){ 
  const colors=['#ff3333','#33ff33','#3333ff','#ffff33','#ff33ff']; 
  objects.push({x:Math.random()*(canvas.width-30),y:0,width:30,height:30,speed:2+Math.random()*4,color:colors[Math.floor(Math.random()*colors.length)]}); 
}
function createParticles(x,y,color){ 
  for(let i=0;i<30;i++) particles.push(new Particle(x,y,color,4,5)); 
}
function updateFallingGame(){
  if(isPaused) return;
  ctx.fillStyle='rgba(0,0,0,0.2)'; 
  ctx.fillRect(0,0,canvas.width,canvas.height);
  for(const p of bgParticles){ p.update(); if(p.y>canvas.height)p.y=0; p.draw(ctx); }
  if(keys['ArrowLeft']) player.velX=-player.speed; 
  else if(keys['ArrowRight']) player.velX=player.speed; 
  else player.velX*=0.8;
  player.x+=player.velX; 
  if(player.x<0) player.x=0; 
  if(player.x+player.width>canvas.width) player.x=canvas.width-player.width;
  ctx.fillStyle='lime'; 
  ctx.shadowColor='lime'; 
  ctx.shadowBlur=30; 
  ctx.fillRect(player.x,player.y,player.width,player.height); 
  ctx.shadowBlur=0;
  if(Math.random()<0.03) generateObject();
  for(let i=objects.length-1;i>=0;i--){
    const obj=objects[i]; 
    obj.y+=obj.speed; 
    ctx.fillStyle=obj.color; 
    ctx.shadowColor=obj.color; 
    ctx.shadowBlur=25; 
    ctx.fillRect(obj.x,obj.y,obj.width,obj.height); 
    ctx.shadowBlur=0;
    if(obj.x<player.x+player.width && obj.x+obj.width>player.x && obj.y<player.y+player.height && obj.y+obj.height>player.y){ 
      score+=10; 
      createParticles(obj.x+obj.width/2,obj.y+obj.height/2,obj.color); 
      objects.splice(i,1);
    }
    else if(obj.y>canvas.height){ 
      lives--; 
      objects.splice(i,1); 
      if(lives<=0){ alert('üíÄ Game Over!'); returnToMenu(); return; }
    }
  }
  for(let i=particles.length-1;i>=0;i--){
    const p=particles[i]; 
    p.update(); p.draw(ctx); 
    if(p.life<=0) particles.splice(i,1);
  }
  updateScoreBoard();
}

// ===================== SNAKE =====================
let snake=[],direction,food,box=20;

function launchSnake(){
  showScreen(gameContainer); 
  currentGame='snake'; 
  score=0;lives=3;updateScoreBoard();
  canvas.style.display='block'; 
  ticTacToeBoard.style.display='none';
  snake=[{x:200,y:200}]; 
  direction='RIGHT'; 
  randomFood();
  document.addEventListener('keydown',e=>{
    if(isPaused) return;
    if(e.key==='ArrowUp' && direction!=='DOWN') direction='UP';
    if(e.key==='ArrowDown' && direction!=='UP') direction='DOWN';
    if(e.key==='ArrowLeft' && direction!=='RIGHT') direction='LEFT';
    if(e.key==='ArrowRight' && direction!=='LEFT') direction='RIGHT';
  });
  gameInterval=setInterval(updateSnake,150);
}

function randomFood(){
  food={
    x:Math.floor(Math.random()*25)*box,
    y:Math.floor(Math.random()*25)*box
  };
}

// Desenha a cobra
function drawSnake(){
  snake.forEach((seg,index)=>{
    if(index===0){
      // Cabe√ßa
      let gradient=ctx.createRadialGradient(seg.x+10,seg.y+10,5,seg.x+10,seg.y+10,20);
      gradient.addColorStop(0,'#00ffff');
      gradient.addColorStop(1,'#007777');
      ctx.fillStyle=gradient;
      ctx.beginPath();
      ctx.roundRect(seg.x,seg.y,box,box,5);
      ctx.fill();
    } else {
      // Corpo
      let gradient=ctx.createLinearGradient(seg.x,seg.y,seg.x+box,seg.y+box);
      gradient.addColorStop(0,'#00ff00');
      gradient.addColorStop(1,'#006600');
      ctx.fillStyle=gradient;
      ctx.beginPath();
      ctx.roundRect(seg.x,seg.y,box,box,5);
      ctx.fill();
    }
  });
}

// Desenha a ma√ß√£
function drawFood(){
  const centerX=food.x+box/2;
  const centerY=food.y+box/2;

  // Corpo da ma√ß√£
  ctx.beginPath();
  ctx.fillStyle='red';
  ctx.shadowColor='red';
  ctx.shadowBlur=15;
  ctx.arc(centerX,centerY,box/2.5,0,Math.PI*2);
  ctx.fill();
  ctx.shadowBlur=0;

  // Cabinho
  ctx.beginPath();
  ctx.strokeStyle='#8B4513';
  ctx.lineWidth=2;
  ctx.moveTo(centerX,centerY-10);
  ctx.lineTo(centerX,centerY-16);
  ctx.stroke();

  // Folha
  ctx.beginPath();
  ctx.fillStyle='green';
  ctx.ellipse(centerX+5,centerY-16,4,6,Math.PI/4,0,Math.PI*2);
  ctx.fill();
}

// Atualiza o jogo Snake
function updateSnake(){
  if(isPaused) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawFood();
  drawSnake();

  let head={...snake[0]};
  if(direction==='UP') head.y-=box;
  if(direction==='DOWN') head.y+=box;
  if(direction==='LEFT') head.x-=box;
  if(direction==='RIGHT') head.x+=box;

  // Colis√£o
  if(head.x<0||head.y<0||head.x>=canvas.width||head.y>=canvas.height||snake.some(seg=>seg.x===head.x&&seg.y===head.y)){
    lives--;
    if(lives<=0){
      alert('üíÄ Game Over!');
      returnToMenu();
      return;
    }
    snake=[{x:200,y:200}];
    direction='RIGHT';
    return;
  }

  // Comer ma√ß√£
  if(head.x===food.x && head.y===food.y){
    score+=10;
    randomFood();
  } else {
    snake.pop();
  }

  snake.unshift(head);
  updateScoreBoard();
}

// ===================== JOGO DA VELHA =====================
let ticBoard=[],currentPlayerTic='X';
function openTicTacToeSettings(){ showScreen(document.getElementById('ticTacToeSettings')); }
function setGameMode(mode){ ticMode=mode; document.getElementById('roundSelection').style.display='block'; }
function confirmTicTacToeSettings(){ totalRounds=parseInt(document.getElementById('roundsInput').value); startCountdown('tictactoe'); }

function launchTicTacToe(){
  showScreen(gameContainer); 
  currentGame='tictactoe';
  canvas.style.display='none'; 
  ticTacToeBoard.style.display='grid'; 
  currentPlayerTic='X'; 
  ticBoard=Array(9).fill('');
  ticTacToeBoard.innerHTML='';
  for(let i=0;i<9;i++){
    const cell=document.createElement('div');
    cell.classList.add('ticCell');
    cell.addEventListener('click',()=>makeMove(i));
    ticTacToeBoard.appendChild(cell);
  }
  updateRoundInfo();
}
function makeMove(i){
  if(ticBoard[i]===''){
    ticBoard[i]=currentPlayerTic;
    ticTacToeBoard.children[i].textContent=currentPlayerTic;
    if(checkWinner(currentPlayerTic)){
      alert(`üéâ Jogador ${currentPlayerTic} venceu a rodada!`);
      roundWins[currentPlayerTic]++;
      checkMatchEnd();
      return;
    } else if(ticBoard.every(cell=>cell!=='')){
      alert('üòê Empate!');
      checkMatchEnd();
      return;
    }
    currentPlayerTic=currentPlayerTic==='X'?'O':'X';
    if(ticMode==='single'&&currentPlayerTic==='O') aiMove();
  }
}
function aiMove(){
  let emptyCells=ticBoard.map((v,idx)=>v===''?idx:null).filter(v=>v!==null);
  let move=emptyCells[Math.floor(Math.random()*emptyCells.length)];
  setTimeout(()=>makeMove(move),500);
}
function checkWinner(player){
  const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  return wins.some(comb=>comb.every(idx=>ticBoard[idx]===player));
}
function checkMatchEnd(){
  currentRound++;
  if(roundWins.X>totalRounds/2 || roundWins.O>totalRounds/2){
    const winner=roundWins.X>roundWins.O?'X':'O';
    alert(`üèÜ Jogador ${winner} venceu a melhor de ${totalRounds} rodadas!`);
    returnToMenu();
  } else {
    launchTicTacToe();
  }
}
function updateRoundInfo(){
  roundInfo.textContent=`Rodada ${currentRound} de ${totalRounds} | X: ${roundWins.X} - O: ${roundWins.O}`;
}
</script>
</body>
</html>
